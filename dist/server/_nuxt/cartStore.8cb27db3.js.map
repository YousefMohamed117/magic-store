{"version":3,"file":"cartStore.8cb27db3.js","sources":["../../../../firebase/config.js","../../../../composables/getProducts.js","../../../../stores/cartStore.js"],"sourcesContent":["import firebase from \"firebase/compat/app\";\r\nimport \"firebase/compat/auth\";\r\nimport \"firebase/compat/firestore\";\r\nimport \"firebase/compat/storage\";\r\nconst firebaseConfig = {\r\n  apiKey: \"AIzaSyAfAdJa0TnQe95YNI5mDTuqSQPIWErl4EE\",\r\n  authDomain: \"yousef-firebase-ae727.firebaseapp.com\",\r\n  projectId: \"yousef-firebase-ae727\",\r\n  storageBucket: \"yousef-firebase-ae727.appspot.com\",\r\n  messagingSenderId: \"805319693962\",\r\n  appId: \"1:805319693962:web:90d5e2ae6e3d97d0a17f73\",\r\n};\r\n\r\n// init firebase\r\nfirebase.initializeApp(firebaseConfig);\r\n\r\n// init firestore service\r\nconst projectFirestore = firebase.firestore();\r\nconst timestamp = firebase.firestore.FieldValue.serverTimestamp;\r\nconst projectStorage = firebase.storage();\r\n// export firestore\r\nexport { projectFirestore, timestamp , projectStorage};\r\n","import { ref } from \"vue\";\r\nimport { projectFirestore } from \"../firebase/config\";\r\n\r\nconst getPosts = (coll) => {\r\n  const posts = ref([]);\r\n  const error = ref(null);\r\n\r\n  const load = async () => {\r\n    try {\r\n      const res = await projectFirestore.collection(coll)\r\n      .get();\r\n      posts.value = res.docs.map((doc) => {\r\n        return { ...doc.data(), id: doc.id };   \r\n      });\r\n    } catch (err) {\r\n      error.value = err.message;\r\n      console.log(error.value)\r\n    }\r\n  };\r\n\r\n  return { posts, error, load };\r\n};\r\n\r\nexport default getPosts;\r\n","import { defineStore } from \"pinia\";\nimport { projectFirestore } from \"~~/firebase/config\";\nimport  getProducts  from \"../composables/getProducts\";\n\nexport const useCartStore = defineStore(\"cart\", {\n  state: () => ({\n    cart: [],\n  }),\n  actions: {\n    async getCart() {\n     \n      const { posts, error, load } = getProducts(\"cart\");\n      await load();\n      this.cart = posts.value;\n  \n    },\n    async deleteFromCart(p) {\n      this.cart = this.cart.filter((e) => e.id != p.id);\n      await projectFirestore.collection(\"cart\").doc(p.id).delete();\n    },\n    async addToCart(p) {\n      if (this.cart.find((e) => e.id == p.id)) {\n        this.incQuantity(p);\n        console.log(\"found\");\n      } else {\n        this.cart.push({ ...p, quantity: 1 });\n        await projectFirestore.collection(\"cart\").add({ ...p, quantity: 1 });\n        console.log('added')\n      }\n    },\n    async incQuantity(p) {\n      let newQ;\n\n      this.cart = this.cart.map((e) => {\n        if (e.id == p.id) {\n          e.quantity++;\n          newQ = e;\n        }\n        return e;\n      });\n\n      await projectFirestore.collection(\"cart\").doc(p.id).update({ quantity: newQ.quantity });\n    },\n    async decQuantity(p) {\n      if (p.quantity <= 1) {\n        this.deleteFromCart(p);\n      }\n      p.quantity -= 1;\n      projectFirestore.collection(\"cart\").doc(p.id).update({ quantity: p.quantity });\n    },\n  },\n  getters: {\n    total() {\n      return this.cart.reduce((p, c) => {\n        return p + c.price * c.quantity;\n      }, 0);\n    },\n    length() {\n      return this.cart.reduce((p, c) => {\n        return p + c.quantity;\n      }, 0);\n    },\n  },\n});\n"],"names":["getProducts"],"mappings":";;;;;;AAIA,MAAM,iBAAiB;AAAA,EACrB,QAAQ;AAAA,EACR,YAAY;AAAA,EACZ,WAAW;AAAA,EACX,eAAe;AAAA,EACf,mBAAmB;AAAA,EACnB,OAAO;AACT;AAGA,SAAS,cAAc,cAAc;AAGrC,MAAM,mBAAmB,SAAS;AAChB,SAAS,UAAU,WAAW;AAC3C,MAAC,iBAAiB,SAAS,QAAO;AChBlC,MAAC,WAAW,CAAC,SAAS;AACzB,QAAM,QAAQ,IAAI,CAAA,CAAE;AACpB,QAAM,QAAQ,IAAI,IAAI;AAEtB,QAAM,OAAO,YAAY;AACvB,QAAI;AACF,YAAM,MAAM,MAAM,iBAAiB,WAAW,IAAI,EACjD;AACD,YAAM,QAAQ,IAAI,KAAK,IAAI,CAAC,QAAQ;AAClC,eAAO,EAAE,GAAG,IAAI,KAAI,GAAI,IAAI,IAAI;MACxC,CAAO;AAAA,IACF,SAAQ,KAAP;AACA,YAAM,QAAQ,IAAI;AAClB,cAAQ,IAAI,MAAM,KAAK;AAAA,IACxB;AAAA,EACL;AAEE,SAAO,EAAE,OAAO,OAAO;AACzB;ACjBY,MAAC,eAAe,YAAY,QAAQ;AAAA,EAC9C,OAAO,OAAO;AAAA,IACZ,MAAM,CAAE;AAAA,EACZ;AAAA,EACE,SAAS;AAAA,IACP,MAAM,UAAU;AAEd,YAAM,EAAE,OAAO,OAAO,KAAI,IAAKA,SAAY,MAAM;AACjD,YAAM,KAAI;AACV,WAAK,OAAO,MAAM;AAAA,IAEnB;AAAA,IACD,MAAM,eAAe,GAAG;AACtB,WAAK,OAAO,KAAK,KAAK,OAAO,CAAC,MAAM,EAAE,MAAM,EAAE,EAAE;AAChD,YAAM,iBAAiB,WAAW,MAAM,EAAE,IAAI,EAAE,EAAE,EAAE;IACrD;AAAA,IACD,MAAM,UAAU,GAAG;AACjB,UAAI,KAAK,KAAK,KAAK,CAAC,MAAM,EAAE,MAAM,EAAE,EAAE,GAAG;AACvC,aAAK,YAAY,CAAC;AAClB,gBAAQ,IAAI,OAAO;AAAA,MAC3B,OAAa;AACL,aAAK,KAAK,KAAK,EAAE,GAAG,GAAG,UAAU,EAAC,CAAE;AACpC,cAAM,iBAAiB,WAAW,MAAM,EAAE,IAAI,EAAE,GAAG,GAAG,UAAU,EAAC,CAAE;AACnE,gBAAQ,IAAI,OAAO;AAAA,MACpB;AAAA,IACF;AAAA,IACD,MAAM,YAAY,GAAG;AACnB,UAAI;AAEJ,WAAK,OAAO,KAAK,KAAK,IAAI,CAAC,MAAM;AAC/B,YAAI,EAAE,MAAM,EAAE,IAAI;AAChB,YAAE;AACF,iBAAO;AAAA,QACR;AACD,eAAO;AAAA,MACf,CAAO;AAED,YAAM,iBAAiB,WAAW,MAAM,EAAE,IAAI,EAAE,EAAE,EAAE,OAAO,EAAE,UAAU,KAAK,SAAU,CAAA;AAAA,IACvF;AAAA,IACD,MAAM,YAAY,GAAG;AACnB,UAAI,EAAE,YAAY,GAAG;AACnB,aAAK,eAAe,CAAC;AAAA,MACtB;AACD,QAAE,YAAY;AACd,uBAAiB,WAAW,MAAM,EAAE,IAAI,EAAE,EAAE,EAAE,OAAO,EAAE,UAAU,EAAE,SAAU,CAAA;AAAA,IAC9E;AAAA,EACF;AAAA,EACD,SAAS;AAAA,IACP,QAAQ;AACN,aAAO,KAAK,KAAK,OAAO,CAAC,GAAG,MAAM;AAChC,eAAO,IAAI,EAAE,QAAQ,EAAE;AAAA,MACxB,GAAE,CAAC;AAAA,IACL;AAAA,IACD,SAAS;AACP,aAAO,KAAK,KAAK,OAAO,CAAC,GAAG,MAAM;AAChC,eAAO,IAAI,EAAE;AAAA,MACd,GAAE,CAAC;AAAA,IACL;AAAA,EACF;AACH,CAAC;"}